{% extends 'base.html.twig' %}

{% block title %}Movies{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('css/loadingAnimation.css') }}">
{% endblock %}

{% block body %}

<main>
    
    <div id="loader"></div>
    
    <div class="container position-relative" id="mainDiv">
        
        <div class="position-absolute top-0 start-100 translate-middle">
            <button onclick="HideAndShowMainSection()" id="btnSeekMovies" type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#popupMoviesForm"><i class="bi bi-search fs-3"></i></button>
        </div>
        
        {% include "_popup/popupMovieForm.html.twig" %}
    
    <section>

    <div class="row">
        <div class="col-12">
            <h3 class="text-center">Les films</h3>
        </div>
    </div>
    
    <div class="row row-cols-1 row-cols-lg-3 justify-content-center">
        {% if movies.results|length > 0 %}
        {% for movie in movies.results %}
        <div class="col-6 col-lg-4 border border-dark rounded m-1 h-50">
            <div class="p-1 text-center border-bottom border-secondary rounded">
                <h5>{{movie.title|capitalize}}</h5>
            </div>
            <div class="p-1 text-center">
                {% if movie.poster_path != "" %}
                <img class="img-fluid" src={{ tmdbBaseUrlPicture ~ movie.poster_path}}
                alt="{{'Image de ' ~ movie.title}}">
                {% else %}
                <p class="position-relative">{{movie.overview|capitalize|u.truncate(70,'...',false)}}<img class="img-fluid"
                            src="{{asset('/image/placeholderWhite.jpg')}}" alt="placeholderWhite.jpg"><i
                            class="bi bi-camera-video-off-fill fs-1 position-absolute top-50 start-50 translate-middle"></i>
                        </p>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <p class="text-center fst-italic">Aucun résultat à afficher</p>
                {% endif %}
            </div>
        </section>
        </main>

{% endblock %}

{% block javascripts %}
<script src="{{asset('/js/loadingAnimation.js')}}"></script>
<script>
    let btnSeekMovies = document.getElementById('btnSeekMovies');
    let btnSeekMoviesCancel = document.getElementById('movies_cancel');
    let moviesSection = document.querySelector('section');

    btnSeekMoviesCancel.setAttribute('onclick',"HideAndShowMainSection()")
    btnSeekMoviesCancel.setAttribute('data-bs-dismiss', "modal");
    btnSeekMoviesCancel.setAttribute('aria-label',"Close");

    function HideAndShowMainSection(){
        moviesSection.classList.toggle('d-none');
    }
</script>
{% endblock %}